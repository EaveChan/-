<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="www.thymeleaf.org">

<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<title>我的报名 - 临床受试者智能匹配系统</title>
<link rel="stylesheet" th:href="@{/vendors/feather/feather.css}">
<link rel="stylesheet" th:href="@{/vendors/ti-icons/css/themify-icons.css}">
<link rel="stylesheet" th:href="@{/vendors/css/vendor.bundle.base.css}">
<link rel="stylesheet" th:href="@{/css/vertical-layout-light/style.css}">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<link rel="stylesheet" th:href="@{/css/participant-mobile.css}">
<link rel="shortcut icon" th:href="@{/images/Ace_Favicon.png}" />
</head>

<body>
	<div class="container-scroller">
		<div th:replace="fragments/topbar :: topbar"></div>
		<div class="page-body-wrapper">
			<div th:replace="fragments/participant-sidebar :: sidebar"></div>
			<div class="main-panel">
				<div class="content-wrapper">
					<div class="row">
						<div class="col-md-12 grid-margin">
							<div class="row">
								<div class="col-12 mb-4">
									<h3 class="font-weight-bold">我的报名</h3>
									<h6 class="font-weight-normal mb-0">查看您的报名记录和审核状态</h6>
								</div>
							</div>
						</div>
					</div>
					
					<!-- 成功/错误消息 -->
					<div th:if="${success}" class="alert alert-success alert-dismissible fade show" role="alert">
						<span th:text="${success}"></span>
						<button type="button" class="close" data-dismiss="alert" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>
					
					<div class="row">
						<div class="col-md-12 grid-margin stretch-card">
							<div class="card">
								<div class="card-body">
									<p class="card-title mb-0">报名记录列表</p>
									<div class="table-responsive">
										<table class="table table-striped table-borderless">
											<thead>
												<tr>
													<th>临床试验名称</th>
													<th>报名时间</th>
													<th>当前状态</th>
													<th>操作</th>
												</tr>
											</thead>
											<tbody>
												<tr th:each="app : ${applications}">
													<td th:text="${app.clinicalTrial.trialName}"></td>
													<td th:text="${#temporals.format(app.createdAt, 'yyyy-MM-dd HH:mm')}"></td>
													<td>
														<label th:if="${app.status == 'PENDING'}" class="badge badge-warning">待审核</label>
														<label th:if="${app.status == 'APPROVED'}" class="badge badge-success">已批准</label>
														<label th:if="${app.status == 'REJECTED'}" class="badge badge-danger">已拒绝</label>
														<label th:if="${app.status == 'ENROLLED'}" class="badge badge-primary">已入组</label>
														<label th:if="${app.status == 'UNDER_REVIEW'}" class="badge badge-info">人工复核</label>
													</td>
													<td>
														<a th:href="@{/participant/trials/{id}(id=${app.clinicalTrial.id})}" class="btn btn-sm btn-info">
															<i class="bi bi-eye"></i> 查看详情
														</a>
														<!-- 只有待审核状态才能撤销 -->
														<form th:if="${app.status == 'PENDING'}" th:action="@{/participant/applications/{id}/cancel(id=${app.id})}" 
															method="post" style="display:inline" onsubmit="return confirm('确定要撤销此报名吗？')">
															<button type="submit" class="btn btn-sm btn-danger">
																<i class="bi bi-x-circle"></i> 撤销报名
															</button>
														</form>
													</td>
												</tr>
												<tr th:if="${#lists.isEmpty(applications)}">
													<td colspan="4" class="text-center">
														<div class="py-4">
															<i class="bi bi-inbox" style="font-size: 3rem; color: #ccc;"></i>
															<p class="mt-3">您还没有报名任何临床试验</p>
															<a th:href="@{/participant/trials}" class="btn btn-primary mt-2">
																<i class="bi bi-search"></i> 浏览临床试验
															</a>
														</div>
													</td>
												</tr>
											</tbody>
										</table>
									</div>
								</div>
							</div>
						</div>
					</div>
					
					<!-- 状态说明 -->
					<div class="row" th:if="${!#lists.isEmpty(applications)}">
						<div class="col-md-12 grid-margin stretch-card">
							<div class="card">
								<div class="card-body">
									<h4 class="card-title">状态说明</h4>
									<ul class="list-unstyled">
										<li class="mb-2">
											<span class="badge badge-warning">待审核</span> - 您的报名申请已提交，正在等待系统智能匹配和研究人员审核
										</li>
										<li class="mb-2">
											<span class="badge badge-info">人工复核</span> - 您的申请需要研究人员进一步评估
										</li>
										<li class="mb-2">
											<span class="badge badge-success">已批准</span> - 您的申请已通过审核，等待入组
										</li>
										<li class="mb-2">
											<span class="badge badge-primary">已入组</span> - 恭喜！您已成功入组该临床试验
										</li>
										<li class="mb-2">
											<span class="badge badge-danger">已拒绝</span> - 很抱歉，您的申请未通过审核
										</li>
									</ul>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	
	<!-- 移动端底部导航栏 -->
	<div th:replace="fragments/participant-mobile-nav :: mobile-nav"></div>
	
	<script th:src="@{/vendors/js/vendor.bundle.base.js}"></script>
	<script th:src="@{/js/off-canvas.js}"></script>
	<script th:src="@{/js/hoverable-collapse.js}"></script>
	<script th:src="@{/js/template.js}"></script>
	<script th:src="@{/js/settings.js}"></script>
	<script th:src="@{/js/todolist.js}"></script>
</body>

</html>
